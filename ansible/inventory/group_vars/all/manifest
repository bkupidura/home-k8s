manifest:
  broker_ha:
    discovery:
      domain: broker-headless.smart-home.svc.cluster.local
  waf:
    levels:
      paranoia: 4
      anomaly_inbound: 5
      anomaly_outbound: 4
    server:
      ha:
        rules: |
          SecRuleRemoveById 920273
          SecRuleRemoveById 921180
          SecRuleRemoveById 931130
          SecRuleRemoveById 942432
          SecRuleRemoveById 920300
          SecRuleRemoveById 920272
          SecRuleRemoveById 942421
          SecRuleRemoveById 942340
          SecRuleRemoveById 942210
          SecRuleRemoveById 942450
          SecRuleRemoveById 942460
      auth:
        rules: |
          SecRuleRemoveById 942421
          SecRuleRemoveById 920273
          SecRuleRemoveById 920272
          SecRuleRemoveById 931130
          SecRuleRemoveById 941101
  alertmanager:
    receivers:
      - name: 'default-receiver'
    inhibit_rules:
      - source_match:
          severity: critical
        target_match:
          severity: warning
        equal:
          - service
      - source_match:
          severity: warning
        target_match:
          severity: info
        equal:
          - service
  metallb:
    config:
      peers:
        - peer-address: 10.0.120.1
          peer-asn: 64501
          my-asn: 64500
      address-pools:
        - name: default
          protocol: bgp
          addresses:
            - 10.0.10.0/24
  recorder:
    volume:
      size: 30Gi
  frigate:
    volume:
      size: 1Gi
  traefik:
    lan_ip:
      - 10.0.120.0/24
      - 10.0.130.0/24
  blocky:
    servers:
      - tcp-tls:8.8.8.8:853
      - tcp-tls:8.8.4.4:853
      - https://1.1.1.1/dns-query
      - https://1.0.0.1/dns-query
    blocking:
      client_group:
        default:
          - malware
          - ads
          - privacy
      blacklist:
        malware:
          - http://hole.cert.pl/domains/domains_hosts.txt
          - https://raw.githubusercontent.com/PolishFiltersTeam/KADhosts/master/KADhosts.txt
          - https://curben.gitlab.io/malware-filter/urlhaus-filter-hosts-online.txt
          - https://raw.githubusercontent.com/MajkiIT/polish-ads-filter/master/polish-pihole-filters/KADhosts.txt
          - https://blocklistproject.github.io/Lists/abuse.txt
          - https://blocklistproject.github.io/Lists/malware.txt
          - https://blocklistproject.github.io/Lists/phishing.txt
          - https://blocklistproject.github.io/Lists/ransomware.txt
        ads:
          - https://pgl.yoyo.org/adservers/serverlist.php?hostformat=hosts&showintro=1&mimetype=plaintext
          - https://raw.githubusercontent.com/MajkiIT/polish-ads-filter/master/polish-pihole-filters/Ad_filter_list_by_Disconnect.txt
          - https://raw.githubusercontent.com/MajkiIT/polish-ads-filter/master/polish-pihole-filters/hostfile.txt
          - https://raw.githubusercontent.com/MajkiIT/polish-ads-filter/master/polish-pihole-filters/adguard_mobile_host.txt
          - https://raw.githubusercontent.com/MajkiIT/polish-ads-filter/master/polish-pihole-filters/adservers.txt
          - https://blocklistproject.github.io/Lists/ads.txt
          - https://blocklistproject.github.io/Lists/fraud.txt
          - https://blocklistproject.github.io/Lists/scam.txt
        privacy:
          - https://raw.githubusercontent.com/MajkiIT/polish-ads-filter/master/polish-pihole-filters/NoTrack_Tracker_Blocklist.txt
          - https://raw.githubusercontent.com/MajkiIT/polish-ads-filter/master/polish-pihole-filters/easy_privacy_host.txt
          - https://blocklistproject.github.io/Lists/tracking.txt
    conditional:
      mapping:
        home: 10.0.120.1
    custom_dns:
      mapping:
      - domain: "esphome.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "k8s.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "grafana.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "storage.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "traefik.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "alertmanager.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "prometheus.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "mqtt.{{ global.domain }}"
        ip: "{{ global.vips.mqtt.ip }}"
      - domain: "frigate.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "recorder.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "unifi.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "node-red.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "z2m.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "ha.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "auth.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
      - domain: "restic.{{ global.domain }}"
        ip: "{{ global.vips.ingress.ip }}"
